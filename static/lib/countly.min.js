!function(e){"use strict";function n(){if(E){v||a();var n={name:E,segment:v};e.add_event({key:"[CLY]_view",dur:d()-P,segmentation:n}),E=null}}function t(n){if(!e.ignore_bots||!z){if(!e.app_key||!e.device_id)return void s("app_key or device_id is missing");n.app_key=e.app_key,n.device_id=e.device_id,n.sdk_name=h,e.country_code&&(n.country_code=e.country_code),e.city&&(n.city=e.city),null!==e.ip_address&&(n.ip_address=e.ip_address),n.timestamp=d();var t=new Date;n.hour=t.getHours(),n.dow=t.getDay(),O.length>C&&O.shift(),O.push(n),Q("cly_queue",O,!0)}}function o(){if("undefined"!=typeof e.q&&e.q.length>0){for(var n,i=0;i<e.q.length;i++)if(n=e.q[i],s("Processing queued call",n),"function"==typeof n)n();else if(n.constructor===Array&&n.length>0)if("undefined"!=typeof e[n[0]])e[n[0]].apply(null,n.slice(1));else{var r=n[0].replace("userData.","");"undefined"!=typeof e.userData[r]&&e.userData[r].apply(null,n.slice(1))}e.q=[]}if(k&&B&&G){var a=d();a-g>60&&(e.session_duration(a-g),g=a)}if(L.length>0){if(L.length<=10)t({events:JSON.stringify(L)}),L=[];else{var u=L.splice(0,10);t({events:JSON.stringify(u)})}Q("cly_event",L)}if(O.length>0&&F&&d()>q){F=!1;var l=O.shift();s("Processing request",l),c(l,function(e,n){s("Request Finished",n,e),e&&(O.unshift(n),q=d()+D),Q("cly_queue",O,!0),F=!0})}setTimeout(o,S)}function i(){return Q("cly_id")||r()}function r(){var e=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==n?t:3&t|8).toString(16)});return n}function a(){var n={};if(n._app_version=e.app_version,screen.width){var t=screen.width?screen.width:"",o=screen.height?screen.height:"";n._resolution=""+t+"x"+o}for(var i,r,a=navigator.appVersion,d=navigator.userAgent,u=navigator.appName,c=[["Opera Mini","Opera Mini"],["Opera","Opera"],["OPR","Opera"],["MSIE","Internet Explorer"],["IEMobile","IE Mobile"],["Edge","Edge"],["CrKey","Chromecast"],["Chromium","Chromium"],["FxiOS","Firefox"],["Trident","Internet Explorer"],["FBAV/","Facebook app"],["baiduboxapp/","Baidu Box App"],["baidubrowser/","Baidu Browser"],["Dolfin","Dolfin"],["Skyfire","Skyfire"],["bolt","Bolt"],["teashark","TeaShark"],["Blazer","Blazer"],["Tizen","Tizen"],["UCWEB","UCBrowser"],["UC.","UCBrowser"],["DiigoBrowser","DiigoBrowser"],["Puffin","Puffin"],["Mercury","Mercury"],["Obigo","ObigoBrowser"],["NF-Browser","NetFront"],["amaya","Amaya"],["Arora","Arora"],["Avant","Avant"],["BlackBerry","BlackBerry"],["RIM","BlackBerry"],["CFNetwork","CFNetwork"],["Camino","Camino"],["Coast","Coast"],["Dalvik","Dalvik"],["Dillo","Dillo"],["DoCoMo","DoCoMo"],["ELinks","ELinks"],["Espial","Espial TV Browser"],["FlyFlow","FlyFlow"],["GSA","Google App"],["Google Desktop","Google Desktop"],["GooglePlus","Google+ App"],["IBrowse","IBrowse"],["Jasmine","Jasmine"],["Kindle","Kindle"],["Konqueror","Konqueror"],["Links","Links"],["Lotus-Notes","Lotus Notes"],["Lynx","Lynx"],["WAP","WAP Browser"],["MiuiBrowser","Miui Browser"],["Nokia","Nokia"],["OneBrowser","OneBrowser"],["Outlook","Outlook"],["Palm","Palm"],["Pinterest","Pinterest App"],["Playstation","Playstation"],["PlayStation","Playstation"],["PLAYSTATION","Playstation"],["Polaris","Polaris"],["QQ","QQbrowser"],["Qt","Qt"],["QuickTime","QuickTime"],["SEMC-Browser","SEMC Browser"],["SamsungBrowser","Samsung Browser"],["SeaMonkey","SeaMonkey"],["Sleipnir","Sleipnir"],["SmartTV","SmartTV WebBrowser"],["Viera","SmartViera"],["Thunderbird","Thunderbird"],["Vivaldi","Vivaldi"],["wOSBrowser","webOS"],["WebTV","WebTV"],["wp-","WordPress App"],["YaBrowser","Yandex Browser"],["iCab","iCab"],["iTunes","iTunes"],["rekonq","rekonq"],["rekonq","rekonq"],["Chrome","Chrome"],["Firefox","Firefox"],["Android","Android"],["Safari","Safari"],["iPhone","Safari"]],l=0;l<c.length;l++)if(d.indexOf(c[l][0])!=-1){u=c[l][1];break}!u&&(i=d.lastIndexOf(" ")+1)<(r=d.lastIndexOf("/"))&&(u=d.substring(i,r),u.toLowerCase()==u.toUpperCase()&&(u=navigator.appName)),n._browser=u;var f="unknown",m=[{s:"Xbox",r:/Xbox/},{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10",r:/(Windows NT 10.0)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Windows Phone",r:/Windows Phone/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OSX",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"SearchBot",r:Y}];for(var p in m){var y=m[p];if(y.r.test(d)){f=y.s;break}}var w="unknown";switch(/Windows/.test(f)&&"Windows Phone"!=f&&(w=/Windows (.*)/.exec(f)[1],f="Windows"),f){case"Mac OSX":w=/Mac OS X (10[\.\_\d]+)/.exec(d)[1];break;case"Windows Phone":w=(/Windows Phone ([\.\_\d]+)/.exec(d)||["","8.0"])[1];break;case"Android":w=/Android ([\.\_\d]+)/.exec(d)[1];break;case"iOS":w=/OS (\d+)_(\d+)_?(\d+)?/.exec(a),w=w[1]+"."+w[2]+"."+(0|w[3])}n._os=f,v=f,n._os_version=w;var g=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if("undefined"!=typeof g&&(n._locale=g),"undefined"!=typeof document.referrer&&document.referrer.length){var _=H.exec(document.referrer);_&&_[11]&&_[11]!=window.location.hostname&&(n._store=document.referrer)}return s("Got metrics",n),n}function s(){e.debug&&"undefined"!=typeof console&&(arguments[1]&&"object"==typeof arguments[1]&&(arguments[1]=JSON.stringify(arguments[1])),console.log(Array.prototype.slice.call(arguments).join("\n")))}function d(){return Math.floor((new Date).getTime()/1e3)}function u(e,n,o){o=o||W;var i="";"object"==typeof e?"undefined"!=typeof e.stack?i=e.stack:("undefined"!=typeof e.name&&(i+=e.name+":"),"undefined"!=typeof e.message&&(i+=e.message+"\n"),"undefined"!=typeof e.fileName&&(i+="in "+e.fileName+"\n"),"undefined"!=typeof e.lineNumber&&(i+="on "+e.lineNumber),"undefined"!=typeof e.columnNumber&&(i+=":"+e.columnNumber)):i=e+"",n=!!n;var r=a(),s={_os:r._os,_os_version:r._os_version,_resolution:r._resolution,_error:i,_app_version:r._app_version,_run:d()-_};s._not_os_specific=!0;var u=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;u&&(s._bat=Math.floor(100*u.level)),"undefined"!=typeof navigator.onLine&&(s._online=!!navigator.onLine),s._background=!document.hasFocus(),N.length>0&&(s._logs=N.join("\n")),N=[],s._nonfatal=n,s._view=(window.location.pathname||"")+(window.location.search||"")+(window.location.hash||""),s._browser=r._browser,"undefined"!=typeof o&&(s._custom=o);try{var c=document.createElement("canvas"),l=c.getContext("experimental-webgl");s._opengl=l.getParameter(l.VERSION)}catch(e){}t({crash:JSON.stringify(s)})}function c(n,t){try{s("Sending XML HTTP request");var o=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null;o.open("GET",e.url+b+"?"+l(n),!0),o.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<300?"function"==typeof t&&t(!1,n):4===this.readyState&&(s("Failed Server XML HTTP request",this.status),"function"==typeof t&&t(!0,n))},o.send()}catch(e){s("Failed XML HTTP request",e),"function"==typeof t&&t(!0,n)}}function l(e){var n=[];for(var t in e)n.push(t+"="+encodeURIComponent(e[t]));return n.join("&")}function f(e){return"/"==e.substr(e.length-1)?e.substr(0,e.length-1):e}function m(e,n){for(var t,o={},i=0;i<n.length;i++)t=n[i],"undefined"!=typeof e[t]&&(o[t]=e[t]);return o}function p(e){return"undefined"==typeof e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function y(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function w(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}var g,v,_,h="javascript_native_web",x=!1,k=!1,b="/i",S=500,C=1e3,O=[],L=[],N=[],T={},W=null,B=!0,M=0,E=null,P=0,A=0,q=0,D=60,X=20,I=0,F=!0,H=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,Y=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO)/,z=!1,G=!0;e.init=function(n){if(!x&&(_=d(),x=!0,O=Q("cly_queue")||[],T={},L=Q("cly_event")||[],n=n||{},S=n.interval||e.interval||S,C=n.queue_size||e.queue_size||C,D=n.fail_timeout||e.fail_timeout||D,X=n.inactivity_time||e.inactivity_time||X,e.debug=n.debug||e.debug||!1,e.app_key=n.app_key||e.app_key||null,e.device_id=n.device_id||e.device_id||i(),e.url=f(n.url||e.url||"https://cloud.count.ly"),e.app_version=n.app_version||e.app_version||"0.0",e.country_code=n.country_code||e.country_code||null,e.city=n.city||e.city||null,e.ip_address=n.ip_address||e.ip_address||null,e.ignore_bots=n.ignore_bots||e.ignore_bots||!0,e.q=e.q||[],s("Countly initialized"),e.loginIsSuccess(),Y.test(navigator.userAgent)&&(z=!0),e.q.constructor!==Array&&(e.q=[]),o(),Q("cly_id",e.device_id),location.search))for(var t=location.search.substring(1).split("&"),r=0;r<t.length;r++){var a=t[r].split("=");"cly_id"==a[0]?Q("cly_cmp_id",a[1]):"cly_uid"==a[0]&&Q("cly_cmp_uid",a[1])}},e.loginIsSuccess=function(n,t){if(s("login is success"),!e.ignore_bots||!z){if(!e.app_key||!e.device_id)return void s("app_key or device_id is missing");var o={};o.app_key=t||e.app_key,o.device_id=e.device_id,o.sdk_name=h,e.country_code&&(o.country_code=e.country_code),e.city&&(o.city=e.city),null!==e.ip_address&&(o.ip_address=e.ip_address),o.timestamp=d();var i=new Date;o.hour=i.getHours(),o.dow=i.getDay();var r=new window.XMLHttpRequest,n=n||e.url+b+"/login?";r.open("GET",n+l(o),!0),r.onreadystatechange=function(){200===this.status&&s("Send login success.")},r.send()}},e.begin_session=function(e){if(!k){s("Session started"),g=d(),k=!0,B=!e;var n={};n.begin_session=1,n.metrics=JSON.stringify(a()),t(n)}},e.session_duration=function(e){k&&(s("Session extended",e),t({session_duration:e}))},e.end_session=function(e){k&&(e=e||d()-g,s("Ending session"),n(),k=!1,t({end_session:1,session_duration:e}),o())},e.change_id=function(n,o){if(e.device_id!=n){var i=e.device_id;e.device_id=n,Q("cly_id",e.device_id),s("Changing id"),o&&t({old_device_id:i})}},e.add_event=function(e){if(!e.key)return void s("Event must have key property");e.count||(e.count=1);var n=["key","count","sum","dur","segmentation"],t=m(e,n);t.timestamp=d();var o=new Date;t.hour=o.getHours(),t.dow=o.getDay(),L.push(t),Q("cly_event",L),s("Adding event: ",e)},e.start_event=function(e){return T[e]?void s("Timed event with key "+e+" already started"):void(T[e]=d())},e.end_event=function(n){return"string"==typeof n&&(n={key:n}),n.key?T[n.key]?(n.dur=d()-T[n.key],e.add_event(n),void delete T[n.key]):void s("Timed event with key "+n.key+" was not started"):void s("Event must have key property")},e.user_details=function(e){s("Adding userdetails: ",e);var n=["name","username","email","organization","phone","picture","gender","byear","custom"];t({user_details:JSON.stringify(m(e,n))})},e.report_conversion=function(e,n){e=e||Q("cly_cmp_id")||"cly_organic",n=n||Q("cly_cmp_uid"),e&&n?t({campaign_id:e,campaign_user:n}):e?t({campaign_id:e}):s("No campaign data found")};var V={},j=function(e,n,t){V[e]||(V[e]={}),"$push"==t||"$pull"==t||"$addToSet"==t?(V[e][t]||(V[e][t]=[]),V[e][t].push(n)):V[e][t]=n};e.userData={set:function(e,n){V[e]=n},set_once:function(e,n){j(e,1,"$setOnce")},increment:function(e){j(e,1,"$inc")},increment_by:function(e,n){j(e,n,"$inc")},multiply:function(e,n){j(e,n,"$mul")},max:function(e,n){j(e,n,"$max")},min:function(e,n){j(e,n,"$min")},push:function(e,n){j(e,n,"$push")},push_unique:function(e,n){j(e,n,"$addToSet")},pull:function(e,n){j(e,n,"$pull")},save:function(){t({user_details:JSON.stringify({custom:V})}),V={}}},e.track_errors=function(e){W=e,window.onerror=function(e,n,t,o,i){if("undefined"!=typeof i)u(i,!1);else{o=o||window.event&&window.event.errorCharacter;var r="";"undefined"!=typeof e&&(r+=e+"\n"),"undefined"!=typeof n&&(r+="at "+n),"undefined"!=typeof t&&(r+=":"+t),"undefined"!=typeof o&&(r+=":"+o),r+="\n";try{for(var a=[],s=arguments.callee.caller;s;)a.push(s.name),s=s.caller;r+=a.join("\n")}catch(e){}u(r,!1)}}},e.log_error=function(e,n){u(e,!0,n)},e.add_log=function(e){N.push(e)},e.stop_time=function(){G&&(G=!1,M=d()-g,A=d()-P)},e.start_time=function(){G||(G=!0,g=d()-M,P=d()-A,A=0)},e.track_sessions=function(){function n(){document[o]?e.stop_time():e.start_time()}function t(){I>=X&&e.start_time(),I=0}e.begin_session(),e.start_time(),J(window,"beforeunload",function(){e.end_session()}),J(window,"unload",function(){e.end_session()});var o="hidden";o in document?document.addEventListener("visibilitychange",n):(o="mozHidden")in document?document.addEventListener("mozvisibilitychange",n):(o="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",n):(o="msHidden")in document?document.addEventListener("msvisibilitychange",n):"onfocusin"in document?(J(window,"focusin",function(){e.start_time()}),J(window,"focusout",function(){e.stop_time()})):(J(window,"focus",function(){e.start_time()}),J(window,"blur",function(){e.stop_time()}),J(window,"pageshow",function(){e.start_time()}),J(window,"pagehide",function(){e.stop_time()})),J(window,"mousemove",t),J(window,"click",t),J(window,"keydown",t),J(window,"scroll",t),setInterval(function(){I++,I>=X&&e.stop_time()},6e4)},e.track_pageview=function(t,o){if(n(),t&&t.constructor===Array&&(o=t,t=null),t=t||window.location.pathname,o&&o.length)for(var i=0;i<o.length;i++)try{var r=new RegExp(o[i]);if(r.test(t))return void s("Ignored:",t)}catch(e){}E=t,P=d(),v||a();var u={name:t,visit:1,segment:v,domain:window.location.hostname};if("undefined"!=typeof document.referrer&&document.referrer.length){var c=H.exec(document.referrer);c&&c[11]&&c[11]!=window.location.hostname&&(u.start=1)}e.add_event({key:"[CLY]_view",segmentation:u})},e.track_view=function(n,t){e.track_pageview(n,t)},e.track_clicks=function(n){function t(n){if(o){if(o=!1,p(n),"undefined"!=typeof n.pageX&&"undefined"!=typeof n.pageY){var t=y(),i=w();e.add_event({key:"[CLY]_action",segmentation:{type:"click",x:n.pageX,y:n.pageY,width:i,height:t,domain:window.location.hostname}})}setTimeout(function(){o=!0},1e3)}}n=n||document;var o=!0;J(n,"mousedown",t),J(n,"mouseup",t),J(n,"click",t)},e.track_links=function(n){function t(){function t(n){var t=$(n);if(p(n),e.add_event({key:"linkClick",segmentation:{href:t.href,text:t.innerText,id:t.id,x:n.pageX,y:n.pageY}}),"undefined"!=typeof t.href&&"_blank"!==t.target&&!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)){var o=t.href.replace(window.location.href.split("#")[0],"");0!==o.indexOf("#")&&e.end_session()}}if("undefined"!=typeof n.getElementsByTagName)for(var o=n.getElementsByTagName("a"),i=0;i<o.length;i++)J(o[i],"click",t);else s("Can't track clicks")}n=n||document,"complete"===document.readyState?t():J(window,"load",t)},e.track_forms=function(n){function t(e){return e.name||e.id||e.type||e.nodeName}function o(n){var o=!1;J(n,"submit",function(i){if(!o){o=!0;var r,a={id:n.id,name:n.name,action:n.action,method:n.method};if("undefined"!=typeof n.elements)for(var s=0;s<n.elements.length;s++)if(r=n.elements[s],r&&"password"!=r.type)if("undefined"==typeof a["input:"+t(r)]&&(a["input:"+t(r)]=[]),"select"==r.nodeName.toLowerCase())if("undefined"!=typeof r.multiple){var d=[];if("undefined"!=typeof r.options)for(var u=0;u<r.options.length;u++)r.options[u].selected&&d.push(r.options[u].value);a["input:"+t(r)].push(d.join(", "))}else a["input:"+t(r)].push(r.options[r.selectedIndex].value);else"input"==r.nodeName.toLowerCase()?"undefined"!=typeof r.type&&("checkbox"==r.type.toLowerCase()||"radio"==r.type.toLowerCase())?r.checked&&a["input:"+t(r)].push(r.value):a["input:"+t(r)].push(r.value):"textarea"==r.nodeName.toLowerCase()?a["input:"+t(r)].push(r.value):"undefined"!=typeof r.value&&a["input:"+t(r)].push(r.value);for(var c in a)"undefined"!=typeof a[c].join&&(a[c]=a[c].join(", "));e.add_event({key:"formSubmit",segmentation:a}),e.end_session()}})}function i(){if("undefined"!=typeof n.getElementsByTagName)for(var e=n.getElementsByTagName("form"),t=0;t<e.length;t++)o(e[t]);else s("Can't track forms")}n=n||document,"complete"===document.readyState?i():J(window,"load",i)},e.collect_from_forms=function(n,t){function o(o){var i=!1;J(o,"submit",function(r){if(!i){i=!0;var a,d={},u=!1;if("undefined"!=typeof o.elements){var c,l,f={},m=n.getElementsByTagName("LABEL");for(c=0;c<m.length;c++)m[c].htmlFor&&""!==m[c].htmlFor&&(f[m[c].htmlFor]=m[c].innerText||m[c].textContent||m[c].innerHTML);for(c=0;c<o.elements.length;c++)if(a=o.elements[c],a&&"password"!=a.type&&a.className.indexOf("cly_user_ignore")==-1){var p="";if("select"==a.nodeName.toLowerCase())if("undefined"!=typeof a.multiple){var y=[];if("undefined"!=typeof a.options)for(l=0;l<a.options.length;l++)a.options[l].selected&&y.push(a.options[l].value);p=y.join(", ")}else p=a.options[a.selectedIndex].value;else"input"==a.nodeName.toLowerCase()?"undefined"!=typeof a.type&&("checkbox"==a.type.toLowerCase()||"radio"==a.type.toLowerCase())?a.checked&&(p=a.value):p=a.value:"textarea"==a.nodeName.toLowerCase()?p=a.value:"undefined"!=typeof a.value&&(p=a.value);if(a.className&&a.className.indexOf("cly_user_")!=-1){var w=a.className.split(" ");for(l=0;l<w.length;l++)if(0===w[l].indexOf("cly_user_")){d[w[l].replace("cly_user_","")]=p,u=!0;break}}else a.type&&"email"==a.type.toLowerCase()||a.name&&a.name.toLowerCase().indexOf("email")!=-1||a.id&&a.id.toLowerCase().indexOf("email")!=-1||a.id&&f[a.id]&&f[a.id].toLowerCase().indexOf("email")!=-1||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(p)?(d.email||(d.email=p),u=!0):a.name&&a.name.toLowerCase().indexOf("username")!=-1||a.id&&a.id.toLowerCase().indexOf("username")!=-1||a.id&&f[a.id]&&f[a.id].toLowerCase().indexOf("username")!=-1?(d.username||(d.username=p),u=!0):a.name&&(a.name.toLowerCase().indexOf("tel")!=-1||a.name.toLowerCase().indexOf("phone")!=-1||a.name.toLowerCase().indexOf("number")!=-1)||a.id&&(a.id.toLowerCase().indexOf("tel")!=-1||a.id.toLowerCase().indexOf("phone")!=-1||a.id.toLowerCase().indexOf("number")!=-1)||a.id&&f[a.id]&&(f[a.id].toLowerCase().indexOf("tel")!=-1||f[a.id].toLowerCase().indexOf("phone")!=-1||f[a.id].toLowerCase().indexOf("number")!=-1)?(d.phone||(d.phone=p),u=!0):a.name&&(a.name.toLowerCase().indexOf("org")!=-1||a.name.toLowerCase().indexOf("company")!=-1)||a.id&&(a.id.toLowerCase().indexOf("org")!=-1||a.id.toLowerCase().indexOf("company")!=-1)||a.id&&f[a.id]&&(f[a.id].toLowerCase().indexOf("org")!=-1||f[a.id].toLowerCase().indexOf("company")!=-1)?(d.organization||(d.organization=p),u=!0):(a.name&&a.name.toLowerCase().indexOf("name")!=-1||a.id&&a.id.toLowerCase().indexOf("name")!=-1||a.id&&f[a.id]&&f[a.id].toLowerCase().indexOf("name")!=-1)&&(d.name||(d.name=""),d.name+=p+" ",u=!0)}}u&&(s("Gathered user data",d),t?e.user_details({custom:d}):e.user_details(d)),e.end_session()}})}function i(){if("undefined"!=typeof n.getElementsByTagName)for(var e=n.getElementsByTagName("form"),t=0;t<e.length;t++)o(e[t]);else s("Can't track forms")}n=n||document,"complete"===document.readyState?i():J(window,"load",i)},e.collect_from_facebook=function(n){FB&&FB.api&&FB.api("/me",function(t){var o={};if(t.name&&(o.name=t.name),t.email&&(o.email=t.email),"male"==t.gender?o.gender="M":"female"==t.gender&&(o.gender="F"),t.birthday){var i=t.birthday.split("/").pop();i&&4==i.length&&(o.byear=i)}if(t.work&&t.work[0]&&t.work[0].employer&&t.work[0].employer.name&&(o.organization=t.work[0].employer.name),n){o.custom={};for(var r in n){for(var a=n[r].split("."),s=t,d=0;d<a.length&&(s=s[a[d]],"undefined"!=typeof s);d++);"undefined"!=typeof s&&(o.custom[r]=s)}}e.user_details(o)})};var J=function(e,n,t){"undefined"!=typeof e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent("on"+n,t)},$=function(e){return e?"undefined"!=typeof e.target?e.target:e.srcElement:window.event.srcElement},Q=function(e,n,t){function o(e,n,t){var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3);var i="; expires="+o.toGMTString();document.cookie=e+"="+n+i+"; path=/"}function i(e){for(var n=e+"=",t=document.cookie.split(";"),o=0,i=t.length;o<i;o++){for(var r=t[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(n))return r.substring(n.length,r.length)}return null}t=t||!1;var r,a=!1;if("undefined"!=typeof localStorage){a=!0;try{localStorage.setItem("testLocal",!0)}catch(e){a=!1}}if("undefined"!=typeof n&&null!==n&&("object"==typeof n&&(n=JSON.stringify(n)),a?localStorage.setItem(e,n):t||o(e,n,30)),"undefined"==typeof n){a?r=localStorage.getItem(e):t||(r=i(e));try{r=JSON.parse(r)}catch(e){r=r}return r}null===n&&(a?localStorage.removeItem(e):t||o(e,"",-1))}}(window.Countly=window.Countly||{});